{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///D:/bitflow_lms/edu-bit-lms/bitflow-frontend/apps/admin/app/results/%5Bid%5D/edit/page.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useState } from \"react\";\r\nimport { useForm } from \"react-hook-form\";\r\nimport { zodResolver } from \"@hookform/resolvers/zod\";\r\nimport { z } from \"zod\";\r\nimport { useMutation, useQuery, useQueryClient } from \"@tanstack/react-query\";\r\nimport { useRouter, useParams } from \"next/navigation\";\r\nimport Link from \"next/link\";\r\nimport { ArrowLeft, Save, Trash2, Award } from \"lucide-react\";\r\n\r\nconst mockResults = [\r\n  { id: \"1\", studentId: \"1\", examId: \"1\", marksObtained: 87, maxMarks: 100, remarks: \"Excellent\" },\r\n];\r\n\r\nconst resultSchema = z.object({\r\n  marksObtained: z.coerce.number().min(0),\r\n  maxMarks: z.coerce.number().min(1),\r\n  remarks: z.string().optional(),\r\n}).refine((data) => data.marksObtained <= data.maxMarks, {\r\n  message: \"Marks obtained cannot exceed max marks\",\r\n  path: [\"marksObtained\"],\r\n});\r\n\r\ntype ResultFormData = z.infer<typeof resultSchema>;\r\n\r\nexport default function EditResultPage() {\r\n  const router = useRouter();\r\n  const params = useParams();\r\n  const queryClient = useQueryClient();\r\n  const [isSubmitting, setIsSubmitting] = useState(false);\r\n  const [isDeleting, setIsDeleting] = useState(false);\r\n\r\n  const resultId = params.id as string;\r\n\r\n  const { data: result, isLoading } = useQuery({\r\n    queryKey: [\"results\", resultId],\r\n    queryFn: async () => {\r\n      await new Promise((resolve) => setTimeout(resolve, 300));\r\n      return mockResults.find((r) => r.id === resultId);\r\n    },\r\n  });\r\n\r\n  const { register, handleSubmit, formState: { errors } } = useForm<ResultFormData>({\r\n    resolver: zodResolver(resultSchema),\r\n    values: result,\r\n  });\r\n\r\n  const updateMutation = useMutation({\r\n    mutationFn: async (data: ResultFormData) => {\r\n      await new Promise((resolve) => setTimeout(resolve, 1000));\r\n      return data;\r\n    },\r\n    onSuccess: () => {\r\n      queryClient.invalidateQueries({ queryKey: [\"results\"] });\r\n      router.push(\"/results\");\r\n    },\r\n  });\r\n\r\n  const deleteMutation = useMutation({\r\n    mutationFn: async () => {\r\n      await new Promise((resolve) => setTimeout(resolve, 1000));\r\n    },\r\n    onSuccess: () => {\r\n      queryClient.invalidateQueries({ queryKey: [\"results\"] });\r\n      router.push(\"/results\");\r\n    },\r\n  });\r\n\r\n  const onSubmit = async (data: ResultFormData) => {\r\n    setIsSubmitting(true);\r\n    try {\r\n      await updateMutation.mutateAsync(data);\r\n    } finally {\r\n      setIsSubmitting(false);\r\n    }\r\n  };\r\n\r\n  const handleDelete = async () => {\r\n    if (!confirm(\"Delete this result?\")) return;\r\n    setIsDeleting(true);\r\n    try {\r\n      await deleteMutation.mutateAsync();\r\n    } finally {\r\n      setIsDeleting(false);\r\n    }\r\n  };\r\n\r\n  if (isLoading || !result) return <div className=\"p-6\">Loading...</div>;\r\n\r\n  return (\r\n    <div className=\"p-6\">\r\n      <div className=\"mb-6\">\r\n        <Link href=\"/results\" className=\"inline-flex items-center text-sm text-gray-500 mb-4\">\r\n          <ArrowLeft className=\"w-4 h-4 mr-1\" />\r\n          Back\r\n        </Link>\r\n        <div className=\"flex justify-between\">\r\n          <h1 className=\"text-2xl font-bold\">Edit Result</h1>\r\n          <button onClick={handleDelete} disabled={isDeleting} className=\"bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700\">\r\n            <Trash2 className=\"w-4 h-4 inline mr-1\" />\r\n            Delete\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      <form onSubmit={handleSubmit(onSubmit)} className=\"max-w-2xl\">\r\n        <div className=\"bg-white rounded-lg border p-6 mb-6\">\r\n          <h2 className=\"text-lg font-semibold mb-4 flex items-center gap-2\">\r\n            <Award className=\"w-5 h-5\" />\r\n            Marks\r\n          </h2>\r\n          <div className=\"space-y-4\">\r\n            <div className=\"grid grid-cols-2 gap-4\">\r\n              <div>\r\n                <label className=\"block text-sm font-medium mb-1\">Marks Obtained *</label>\r\n                <input type=\"number\" {...register(\"marksObtained\")} className=\"w-full px-4 py-2 border rounded-lg\" />\r\n                {errors.marksObtained && <p className=\"text-red-500 text-sm mt-1\">{errors.marksObtained.message}</p>}\r\n              </div>\r\n              <div>\r\n                <label className=\"block text-sm font-medium mb-1\">Max Marks *</label>\r\n                <input type=\"number\" {...register(\"maxMarks\")} className=\"w-full px-4 py-2 border rounded-lg\" />\r\n                {errors.maxMarks && <p className=\"text-red-500 text-sm mt-1\">{errors.maxMarks.message}</p>}\r\n              </div>\r\n            </div>\r\n            <div>\r\n              <label className=\"block text-sm font-medium mb-1\">Remarks</label>\r\n              <textarea {...register(\"remarks\")} rows={3} className=\"w-full px-4 py-2 border rounded-lg\" />\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"flex gap-4\">\r\n          <button type=\"submit\" disabled={isSubmitting} className=\"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700\">\r\n            <Save className=\"w-4 h-4 inline mr-1\" />\r\n            Save\r\n          </button>\r\n          <Link href=\"/results\" className=\"bg-gray-100 px-6 py-2 rounded-lg\">Cancel</Link>\r\n        </div>\r\n      </form>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AAAA;AAAA;AAAA;;;AATA;;;;;;;;;AAWA,MAAM,cAAc;IAClB;QAAE,IAAI;QAAK,WAAW;QAAK,QAAQ;QAAK,eAAe;QAAI,UAAU;QAAK,SAAS;IAAY;CAChG;AAED,MAAM,eAAe,wQAAC,CAAC,MAAM,CAAC;IAC5B,eAAe,wQAAC,CAAC,MAAM,CAAC,MAAM,GAAG,GAAG,CAAC;IACrC,UAAU,wQAAC,CAAC,MAAM,CAAC,MAAM,GAAG,GAAG,CAAC;IAChC,SAAS,wQAAC,CAAC,MAAM,GAAG,QAAQ;AAC9B,GAAG,MAAM,CAAC,CAAC,OAAS,KAAK,aAAa,IAAI,KAAK,QAAQ,EAAE;IACvD,SAAS;IACT,MAAM;QAAC;KAAgB;AACzB;AAIe,SAAS;;IACtB,MAAM,SAAS,IAAA,0YAAS;IACxB,MAAM,SAAS,IAAA,0YAAS;IACxB,MAAM,cAAc,IAAA,yXAAc;IAClC,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,iaAAQ,EAAC;IACjD,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,iaAAQ,EAAC;IAE7C,MAAM,WAAW,OAAO,EAAE;IAE1B,MAAM,EAAE,MAAM,MAAM,EAAE,SAAS,EAAE,GAAG,IAAA,wWAAQ,EAAC;QAC3C,UAAU;YAAC;YAAW;SAAS;QAC/B,OAAO;uCAAE;gBACP,MAAM,IAAI;+CAAQ,CAAC,UAAY,WAAW,SAAS;;gBACnD,OAAO,YAAY,IAAI;+CAAC,CAAC,IAAM,EAAE,EAAE,KAAK;;YAC1C;;IACF;IAEA,MAAM,EAAE,QAAQ,EAAE,YAAY,EAAE,WAAW,EAAE,MAAM,EAAE,EAAE,GAAG,IAAA,mVAAO,EAAiB;QAChF,UAAU,IAAA,+XAAW,EAAC;QACtB,QAAQ;IACV;IAEA,MAAM,iBAAiB,IAAA,8WAAW,EAAC;QACjC,UAAU;0DAAE,OAAO;gBACjB,MAAM,IAAI;kEAAQ,CAAC,UAAY,WAAW,SAAS;;gBACnD,OAAO;YACT;;QACA,SAAS;0DAAE;gBACT,YAAY,iBAAiB,CAAC;oBAAE,UAAU;wBAAC;qBAAU;gBAAC;gBACtD,OAAO,IAAI,CAAC;YACd;;IACF;IAEA,MAAM,iBAAiB,IAAA,8WAAW,EAAC;QACjC,UAAU;0DAAE;gBACV,MAAM,IAAI;kEAAQ,CAAC,UAAY,WAAW,SAAS;;YACrD;;QACA,SAAS;0DAAE;gBACT,YAAY,iBAAiB,CAAC;oBAAE,UAAU;wBAAC;qBAAU;gBAAC;gBACtD,OAAO,IAAI,CAAC;YACd;;IACF;IAEA,MAAM,WAAW,OAAO;QACtB,gBAAgB;QAChB,IAAI;YACF,MAAM,eAAe,WAAW,CAAC;QACnC,SAAU;YACR,gBAAgB;QAClB;IACF;IAEA,MAAM,eAAe;QACnB,IAAI,CAAC,QAAQ,wBAAwB;QACrC,cAAc;QACd,IAAI;YACF,MAAM,eAAe,WAAW;QAClC,SAAU;YACR,cAAc;QAChB;IACF;IAEA,IAAI,aAAa,CAAC,QAAQ,qBAAO,qbAAC;QAAI,WAAU;kBAAM;;;;;;IAEtD,qBACE,qbAAC;QAAI,WAAU;;0BACb,qbAAC;gBAAI,WAAU;;kCACb,qbAAC,kaAAI;wBAAC,MAAK;wBAAW,WAAU;;0CAC9B,qbAAC,kYAAS;gCAAC,WAAU;;;;;;4BAAiB;;;;;;;kCAGxC,qbAAC;wBAAI,WAAU;;0CACb,qbAAC;gCAAG,WAAU;0CAAqB;;;;;;0CACnC,qbAAC;gCAAO,SAAS;gCAAc,UAAU;gCAAY,WAAU;;kDAC7D,qbAAC,yXAAM;wCAAC,WAAU;;;;;;oCAAwB;;;;;;;;;;;;;;;;;;;0BAMhD,qbAAC;gBAAK,UAAU,aAAa;gBAAW,WAAU;;kCAChD,qbAAC;wBAAI,WAAU;;0CACb,qbAAC;gCAAG,WAAU;;kDACZ,qbAAC,kXAAK;wCAAC,WAAU;;;;;;oCAAY;;;;;;;0CAG/B,qbAAC;gCAAI,WAAU;;kDACb,qbAAC;wCAAI,WAAU;;0DACb,qbAAC;;kEACC,qbAAC;wDAAM,WAAU;kEAAiC;;;;;;kEAClD,qbAAC;wDAAM,MAAK;wDAAU,GAAG,SAAS,gBAAgB;wDAAE,WAAU;;;;;;oDAC7D,OAAO,aAAa,kBAAI,qbAAC;wDAAE,WAAU;kEAA6B,OAAO,aAAa,CAAC,OAAO;;;;;;;;;;;;0DAEjG,qbAAC;;kEACC,qbAAC;wDAAM,WAAU;kEAAiC;;;;;;kEAClD,qbAAC;wDAAM,MAAK;wDAAU,GAAG,SAAS,WAAW;wDAAE,WAAU;;;;;;oDACxD,OAAO,QAAQ,kBAAI,qbAAC;wDAAE,WAAU;kEAA6B,OAAO,QAAQ,CAAC,OAAO;;;;;;;;;;;;;;;;;;kDAGzF,qbAAC;;0DACC,qbAAC;gDAAM,WAAU;0DAAiC;;;;;;0DAClD,qbAAC;gDAAU,GAAG,SAAS,UAAU;gDAAE,MAAM;gDAAG,WAAU;;;;;;;;;;;;;;;;;;;;;;;;kCAK5D,qbAAC;wBAAI,WAAU;;0CACb,qbAAC;gCAAO,MAAK;gCAAS,UAAU;gCAAc,WAAU;;kDACtD,qbAAC,+WAAI;wCAAC,WAAU;;;;;;oCAAwB;;;;;;;0CAG1C,qbAAC,kaAAI;gCAAC,MAAK;gCAAW,WAAU;0CAAmC;;;;;;;;;;;;;;;;;;;;;;;;AAK7E;GApHwB;;QACP,0YAAS;QACT,0YAAS;QACJ,yXAAc;QAME,wWAAQ;QAQc,mVAAO;QAK1C,8WAAW;QAWX,8WAAW;;;KAjCZ","debugId":null}}]
}